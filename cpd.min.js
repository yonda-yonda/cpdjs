/*! cpdjs v1.0.0 | yonda <yonda.fountain@gmail.com> | license: MIT */
!function(r,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.cpd=e():r.cpd=e()}(self,(function(){return(()=>{"use strict";var r={758:function(r,e){var t,o=this&&this.__extends||(t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,e){r.__proto__=e}||function(r,e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t])},t(r,e)},function(r,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.UnconvergencedError=e.InvalidArgumentError=void 0;var n=function(r){function e(e){var t=this.constructor,o=r.call(this,e)||this;return Object.setPrototypeOf(o,t.prototype),o}return o(e,r),e}(Error),i=function(r){function e(e){return void 0===e&&(e="Invalid arguments."),r.call(this,e)||this}return o(e,r),e}(n);e.InvalidArgumentError=i;var a=function(r){function e(e){return void 0===e&&(e="Unconvergenced."),r.call(this,e)||this}return o(e,r),e}(n);e.UnconvergencedError=a},607:function(r,e,t){var o=this&&this.__createBinding||(Object.create?function(r,e,t,o){void 0===o&&(o=t),Object.defineProperty(r,o,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,o){void 0===o&&(o=t),r[o]=e[t]}),n=this&&this.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),i=this&&this.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(null!=r)for(var t in r)"default"!==t&&Object.prototype.hasOwnProperty.call(r,t)&&o(e,r,t);return n(e,r),e};Object.defineProperty(e,"__esModule",{value:!0}),e.errors=e.utils=e.svd=e.peek=e.sst=void 0,e.sst=i(t(943)),e.peek=i(t(339)),e.svd=i(t(499)),e.utils=i(t(593)),e.errors=i(t(758))},339:(r,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.quartile=e.find=void 0;var o=t(758);e.find=function(r,e){var t=(null==e?void 0:e.neighbor)?e.neighbor>r.length?r.length:e.neighbor:1,n=void 0===(null==e?void 0:e.threshold)?-1/0:e.threshold;if(t<1)throw new o.InvalidArgumentError("neighbor is must be more than 0.");for(var i=[],a=0;a<r.length;a++)if(void 0!==r[a]&&r[a]>=n){for(var u=!0,f=!1,l=!1,s=r[a],v=1;v<=t;v++){if(void 0!==r[a+v]){var h=r[a+v];if(l){if(h>=s){u=!1;break}}else{if(h>s){u=!1;break}h<s&&(l=!0)}}if(void 0!==r[a-v]){var d=r[a-v];if(f){if(d>=s){u=!1;break}}else{if(d>s){u=!1;break}d<s&&(f=!0)}}}i.push(l&&f&&u)}else i.push(!1);return i};e.quartile=function(r){var e=r.filter((function(r){return void 0!==r})).sort((function(r,e){return r<e?1:r>e?-1:0}));if(e.length<1)throw new o.InvalidArgumentError("values must contain at least one number.");var t,n,i,a,u,f=e[0],l=e[e.length-1],s=e.length-1;if(e.length%2!=0){var v=Math.floor(e.length/2);t=e[v],a=v-1,u=v+1}else a=e.length/2-1,u=e.length/2,t=(e[a]+e[u])/2;var h=a-0+1;n=h%2!=0?e[Math.floor(h/2)]:(e[h/2-1]+e[h/2])/2;var d=s-u+1;return{min:l,max:f,first:i=d%2!=0?e[u+Math.floor(d/2)]:(e[u+d/2-1]+e[u+d/2])/2,second:t,third:n,iqr:n-i}}},943:(r,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.score=e.recomposition=void 0;var o=t(593),n=t(499),i=t(758);e.recomposition=function(r,e){for(var t=[],o=function(o){var n=[];e.forEach((function(e){n.push(r[o][e])})),t.push(n)},n=0;n<r.length;n++)o(n);return t};e.score=function(r,t,a){var u,f,l,s,v=r.length,h=(null==a?void 0:a.lag)?a.lag:Math.ceil(t/2),d=(null===(u=null==a?void 0:a.trajectory)||void 0===u?void 0:u.k)?a.trajectory.k:Math.ceil(t/2),c=(null===(f=null==a?void 0:a.trajectory)||void 0===f?void 0:f.m)?a.trajectory.m:Math.min(d,2),m=(null===(l=null==a?void 0:a.test)||void 0===l?void 0:l.k)?a.test.k:Math.ceil(t/2),p=(null===(s=null==a?void 0:a.test)||void 0===s?void 0:s.m)?a.test.m:Math.min(m,2);if(h<1)throw new i.InvalidArgumentError("lag is must be more than 0.");if(d<1)throw new i.InvalidArgumentError("col of trajectory matrix is must be more than 0.");if(d<c)throw new i.InvalidArgumentError("m of trajectory is must be less than col of trajectory.");if(m<1)throw new i.InvalidArgumentError("col of test matrix is must be more than 0.");if(m<p)throw new i.InvalidArgumentError("m of test is must be less than col of test.");var g=t+d-1,b=v-h;if(g>v-1||b<0||v+h-m-t<0)throw new i.InvalidArgumentError("out of range.");for(var w=Array(v),M=g;M<=b;M++){var y=(0,o.embed)(r,M,t,d),_=(0,n.svd)(y),E=_[0],j=_[1],O=(0,o.indexOrder)(E),x=(0,o.embed)(r,M+h,t,m),I=(0,n.svd)(x),A=I[0],k=I[1],P=(0,o.indexOrder)(A),q=(0,e.recomposition)(j,O.slice(0,c).map((function(r){return r.index}))),Z=(0,e.recomposition)(k,P.slice(0,p).map((function(r){return r.index}))),U=(0,n.svd)((0,o.mult)((0,o.transpose)(q),Z),null==a?void 0:a.svd)[0],N=(0,o.indexOrder)(U);w[M]=1-Math.pow(N[0].value,2)}return w}},499:(r,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.svd=void 0;var o=t(593),n=t(758);e.svd=function(r,e){var t,i=(null==e?void 0:e.maxIter)?e.maxIter:50,a=(null==e?void 0:e.beta)?e.beta:Number.MIN_VALUE,u=(null==e?void 0:e.eps)?e.eps:Number.EPSILON,f=a/u,l=r.length;if(l<1)throw new n.InvalidArgumentError("row size must be more than 0.");var s=r[0].length;if(s<1)throw new n.InvalidArgumentError("col size a must be more than 0.");var v=l>=s,h=v?(0,o.copy)(r):(0,o.copy)((0,o.transpose)(r));v||(l=(t=[s,l])[0],s=t[1]);for(var d=(0,o.vZeros)(s),c=(0,o.vZeros)(s),m=(0,o.mZeros)(s),p=0,g=0,b=0;b<s;b++){c[b]=p;for(var w=0,M=b+1,y=b;y<l;y++)w+=Math.pow(h[y][b],2);if(w<f)p=0;else{var _=(I=h[b][b])*(p=I<0?Math.sqrt(w):-Math.sqrt(w))-w;h[b][b]=I-p;for(y=M;y<s;y++){for(var E=0,j=b;j<l;j++)E+=h[j][b]*h[j][y];var O=E/_;for(j=b;j<l;j++)h[j][y]+=O*h[j][b]}}d[b]=p,w=0;for(y=M;y<s;y++)w+=Math.pow(h[b][y],2);if(w<f)p=0;else{_=(I=h[b][M])*(p=I<0?Math.sqrt(w):-Math.sqrt(w))-w;h[b][M]=I-p;for(y=M;y<s;y++)c[y]=h[b][y]/_;for(y=M;y<l;y++){var x=0;for(j=M;j<s;j++)x+=h[y][j]*h[b][j];for(j=M;j<s;j++)h[y][j]+=x*c[j]}}(C=Math.abs(d[b])+Math.abs(c[b]))>g&&(g=C)}for(b=s-1;b>=0;b--){M=b+1;if(0!==p){for(_=h[b][M]*p,y=M;y<s;y++)m[y][b]=h[b][y]/_;for(y=M;y<s;y++){for(w=0,j=M;j<s;j++)w+=h[b][j]*m[j][y];for(j=M;j<s;j++)m[j][y]+=w*m[j][b]}}for(y=M;y<s;y++)m[b][y]=0,m[y][b]=0;m[b][b]=1,p=c[b]}for(b=s-1;b>=0;b--){M=b+1;p=d[b];for(y=M;y<s;y++)h[b][y]=0;if(0!==p){for(_=h[b][b]*p,y=M;y<s;y++){for(w=0,j=M;j<l;j++)w+=h[j][b]*h[j][y];var I=w/_;for(j=b;j<l;j++)h[j][y]+=I*h[j][b]}for(y=b;y<l;y++)h[y][b]/=p}else for(y=b;y<l;y++)h[y][b]=0;h[b][b]+=1}u*=g;for(j=s-1;j>=0;j--){for(var A=1/0,k=0;++k;){M=void 0;var P=!1;for(M=j;M>=0;M--){if(Math.abs(c[M])<=u){P=!0;break}if(Math.abs(d[M-1])<=u)break}if(!P){var q=0,Z=1,U=M-1;for(b=M;b<=j;b++){var N=Z*c[b];if(c[b]*=q,Math.abs(N)<=u)break;var z=d[b],S=Math.sqrt(Math.pow(N,2)+Math.pow(z,2));d[b]=S,q=z/S,Z=-N/S;for(y=0;y<l;y++){var L=h[y][U],B=h[y][b];h[y][U]=L*q+B*Z,h[y][b]=-L*Z+B*q}}}if(A=d[j],M===j)break;if(k>=i)throw new n.UnconvergencedError;var C,D=d[M],T=c[j-1];I=(((C=d[j-1])-A)*(C+A)+(T-(_=c[j]))*(T+_))/(2*_*C);T=Math.sqrt(Math.pow(I,2)+1),I=((D-A)*(D+A)+_*(C/(I<0?I-T:I+T)-_))/D;var V=1;for(w=1,b=M+1;b<=j;b++){var F=c[b],G=d[b],H=w*F;F*=V;var J=Math.sqrt(Math.pow(I,2)+Math.pow(H,2));c[b-1]=J,I=D*(V=I/J)+F*(w=H/J),F=-D*w+F*V,H=G*w,G*=V;for(y=0;y<s;y++){var K=m[y][b-1],Q=m[y][b];m[y][b-1]=K*V+Q*w,m[y][b]=-K*w+Q*V}J=Math.sqrt(Math.pow(I,2)+Math.pow(H,2)),d[b-1]=J,I=(V=I/J)*F+(w=H/J)*G,D=-w*F+V*G;for(y=0;y<l;y++){var R=h[y][b-1],W=h[y][b];h[y][b-1]=R*V+W*w,h[y][b]=-R*w+W*V}}c[M]=0,c[j]=I,d[j]=D}if(A<0){d[j]=-A;for(y=0;y<s;y++)m[y][j]*=-1}}return v?[d,h,m]:[d,m,h]}},593:(r,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.embed=e.indexOrder=e.identity=e.mult=e.transpose=e.copy=e.mZeros=e.vZeros=void 0;var o=t(758);e.vZeros=function(r){if(r<1)throw new o.InvalidArgumentError("m must be more than 0.");return Array(r).fill(0)};e.mZeros=function(r,t){if(r<1)throw new o.InvalidArgumentError("row must be more than 0.");if(t&&t<1)throw new o.InvalidArgumentError("col must be more than 0.");for(var n=r,i=t||r,a=[],u=0;u<n;u++)a.push((0,e.vZeros)(i));return a};e.copy=function(r){for(var e=r.length,t=[],o=0;o<e;o++){for(var n=[],i=r[o].length,a=0;a<i;a++)n.push(r[o][a]);t.push(n)}return t};e.transpose=function(r){for(var e,t=[],o=r.length,n=null===(e=r[0])||void 0===e?void 0:e.length,i=0;i<n;i++){for(var a=[],u=0;u<o;u++)a.push(r[u][i]);t.push(a)}return t};e.mult=function(r,e){var t;if((null===(t=r[0])||void 0===t?void 0:t.length)!==e.length)throw new o.InvalidArgumentError("Matrices don't match size.");for(var n=[],i=0;i<r.length;i++){for(var a=[],u=0;u<e[0].length;u++){for(var f=0,l=0;l<r[0].length;l++)f+=r[i][l]*e[l][u];a.push(f)}n.push(a)}return n};e.identity=function(r,e){if(r<1)throw new o.InvalidArgumentError("row must be more than 0.");if(e&&e<1)throw new o.InvalidArgumentError("col must be more than 0.");for(var t=r,n=e||r,i=[],a=0;a<t;a++){for(var u=[],f=0;f<n;f++)f===a?u.push(1):u.push(0);i.push(u)}return i};e.indexOrder=function(r){var e=r.map((function(r,e){return{value:r,index:e}}));return e.sort((function(r,e){return r.value<e.value?1:r.value>e.value?-1:0})),e};e.embed=function(r,t,n,i){if(t-i-n+1<0||t>r.length)throw new o.InvalidArgumentError("out of range.");for(var a=(0,e.mZeros)(n,i),u=0;u<n;u++)for(var f=0;f<i;f++)a[u][f]=r[t-(i-f)-n+1+u];return a}}},e={};var t=function t(o){var n=e[o];if(void 0!==n)return n.exports;var i=e[o]={exports:{}};return r[o].call(i.exports,i,i.exports,t),i.exports}(607);return t})()}));